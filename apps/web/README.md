# CampusMatch Web App

A mobile-first Progressive Web Application (PWA) built with Next.js 16, TypeScript, and Tailwind CSS for connecting students around campus.

## Features

- ðŸš€ **Next.js 16** with App Router for optimal performance
- ðŸ“± **Mobile-First Design** with responsive breakpoints
- ðŸŽ¯ **PWA Support** with offline capabilities and installable experience
- ðŸŒ™ **Dark Mode** with system preference detection
- ðŸ”” **Push Notifications** for real-time updates
- ðŸŽ¨ **Modern UI** with Tailwind CSS and smooth animations
- ðŸ§ª **Comprehensive Testing** with Playwright E2E tests

## Quick Start

### Prerequisites

- Node.js 18.19.0+ (use `.nvmrc`)
- pnpm 8+ (workspace manager)

### Development

```bash
# Install dependencies (from root)
pnpm install

# Start development server
pnpm dev --filter @campusmatch/web

# Or navigate to the app directory
cd apps/web
pnpm dev
```

The app will be available at `http://localhost:3000`.

### Build & Production

```bash
# Build for production
pnpm build --filter @campusmatch/web

# Start production server
pnpm start --filter @campusmatch/web
```

## Mobile Experience

CampusMatch is designed primarily for mobile devices. Desktop users will see a landing page with an option to continue in preview mode.

### Mobile Testing

1. **Browser DevTools**: Use Chrome DevTools device emulation
   - Open DevTools (F12)
   - Click device toggle (Ctrl+Shift+M)
   - Select mobile device (e.g., iPhone 12, Pixel 5)

2. **Real Devices**: Test on actual mobile browsers
   - Access `http://[your-ip]:3000` on your mobile device
   - Ensure both devices are on the same network

3. **Virtualization**: Use device emulators
   - iOS Simulator (Xcode)
   - Android Emulator (Android Studio)

## PWA Features

### Installation

1. Open the app in a mobile browser
2. Look for the "Add to Home Screen" prompt
3. Tap "Install" to add to your device

### Offline Support

- Core features work offline
- Automatic caching of static assets
- Background sync for likes and messages
- Offline fallback page

### Service Worker

The service worker is automatically generated by `next-pwa` and handles:
- Runtime caching for API responses
- Background sync queue
- Offline fallback routing

## Development Commands

```bash
# Development
pnpm dev              # Start dev server
pnpm build            # Build for production
pnpm start            # Start production server

# Code Quality
pnpm lint             # Run ESLint
pnpm typecheck        # Run TypeScript checks
pnpm format           # Format code with Prettier
pnpm test             # Run Playwright tests
pnpm clean            # Clean build artifacts

# Individual scripts
pnpm dev              # next dev
pnpm build            # next build
pnpm start            # next start
pnpm lint             # next lint
pnpm test             # playwright test
```

## Testing

### E2E Tests

```bash
# Run all tests
pnpm test

# Run tests in headed mode (useful for debugging)
pnpm test --headed

# Run tests on specific browser
pnpm test --project=chromium
pnpm test --project="Mobile Chrome"

# Debug tests
pnpm test --debug
```

### Test Coverage

- Mobile redirect functionality
- Route navigation
- PWA manifest validation
- Service worker registration
- Loading states and skeletons

## Project Structure

```
apps/web/
â”œâ”€â”€ app/                    # Next.js App Router
â”‚   â”œâ”€â”€ (app)/             # Route groups for main app
â”‚   â”‚   â”œâ”€â”€ home/          # Home page
â”‚   â”‚   â”œâ”€â”€ feed/          # Campus feed
â”‚   â”‚   â”œâ”€â”€ chats/         # Messaging
â”‚   â”‚   â”œâ”€â”€ profile/       # User profile
â”‚   â”‚   â””â”€â”€ events/        # Campus events
â”‚   â”œâ”€â”€ landing/           # Desktop landing page
â”‚   â”œâ”€â”€ layout.tsx         # Root layout
â”‚   â”œâ”€â”€ globals.css        # Global styles
â”‚   â””â”€â”€ route-guard.tsx    # Mobile/desktop routing
â”œâ”€â”€ components/            # Reusable components
â”‚   â”œâ”€â”€ navigation/       # Navigation components
â”‚   â”œâ”€â”€ providers/         # Context providers
â”‚   â”œâ”€â”€ push/             # Push notification components
â”‚   â””â”€â”€ analytics/        # Analytics components
â”œâ”€â”€ hooks/                # Custom React hooks
â”œâ”€â”€ lib/                  # Utility functions
â”œâ”€â”€ public/               # Static assets
â”‚   â”œâ”€â”€ icons/           # PWA icons
â”‚   â”œâ”€â”€ manifest.webmanifest
â”‚   â””â”€â”€ offline.html     # Offline fallback
â”œâ”€â”€ tests/               # Playwright tests
â””â”€â”€ *.config.*           # Configuration files
```

## Configuration

### Environment Variables

Create a `.env.local` file for local development:

```env
# Analytics (optional)
NEXT_PUBLIC_GA_ID=your-google-analytics-id

# Firebase (for future integration)
NEXT_PUBLIC_FIREBASE_API_KEY=your-api-key
NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=your-project.firebaseapp.com
```

### PWA Configuration

PWA settings are configured in `next.config.mjs`:
- Runtime caching strategies
- Background sync for offline actions
- Offline fallback routing

## Troubleshooting

### Common Issues

1. **Desktop users can't access the app**
   - Use the "Continue on Desktop" button on the landing page
   - Or set `localStorage.setItem('desktop-override', 'true')` in browser console

2. **PWA not installing**
   - Ensure HTTPS in production
   - Check that the service worker is registered
   - Verify manifest.json is accessible

3. **Service worker issues**
   - Clear browser cache and reload
   - Check DevTools > Application > Service Workers
   - Verify `next-pwa` is disabled in development

4. **Build errors**
   - Run `pnpm clean` before building
   - Check TypeScript errors with `pnpm typecheck`
   - Verify all dependencies are installed

### Debug Tools

- **Chrome DevTools**: Device emulation, network throttling, service worker debugging
- **Lighthouse**: PWA audit and performance analysis
- **Playwright Test Runner**: Visual debugging of E2E tests

## Contributing

1. Follow the existing code style and patterns
2. Add tests for new features
3. Ensure mobile responsiveness
4. Test PWA functionality
5. Update documentation as needed

## License

This project is part of the CampusMatch monorepo.